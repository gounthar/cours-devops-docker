[{invert}]
= Pr√©parer votre environnement de travail

// Particularit√©s de la fac
== Particularit√©s du r√©seau
include::./sous-chapitres/dev-env/proxy.adoc[leveloffset=1]

// Environnement Cloud
== Environnement Cloud : GitHub Codespaces ‚òÅÔ∏è

include::./sous-chapitres/dev-env/github-codespaces.adoc[leveloffset=-1]

== üê≥ Installation locale de Docker

=== Ubuntu 25.04 et le conflit Podman ‚ö†Ô∏è

**Probl√®me :** Ubuntu 25.04+ est livr√© avec Podman par d√©faut, ce qui peut emp√™cher Docker de fonctionner correctement.

**Sympt√¥me :** Erreur "Cannot connect to the Docker daemon"

=== Solutions au conflit

[.columns]
--
[.column]
--
.Solution 1 : Variable DOCKER_HOST (rapide)

**Pour une session :**
[source,bash]
----
# V√©rifier que le service Docker tourne :
systemctl is-active --quiet docker || echo "‚ö†Ô∏è Docker n'est pas d√©marr√© (voir Solution 2)"
export DOCKER_HOST=unix:///var/run/docker.sock
docker ps  # Devrait fonctionner
----

**Permanent (ajouter √† ~/.bashrc ou ~/.zshrc) :**
[source,bash]
----
echo 'export DOCKER_HOST=unix:///var/run/docker.sock' >> ~/.bashrc && source ~/.bashrc
# ou pour zsh :
echo 'export DOCKER_HOST=unix:///var/run/docker.sock' >> ~/.zshrc && source ~/.zshrc
----
--
[.column]
--
.Solution 2 : D√©sinstaller Podman (recommand√©)

**Si vous n'utilisez pas Podman :**
[source,bash]
----
sudo apt remove podman podman-docker
sudo apt install docker.io
sudo systemctl enable --now docker
# Ajouter l'utilisateur au groupe docker
sudo usermod -aG docker $USER
# (optionnel mais utile pour le cours)
sudo apt install -y docker-compose-plugin
newgrp docker <<'EOF'
docker ps
EOF
----

**‚ö†Ô∏è Attention :** Apr√®s `usermod`, vous devez fermer votre session (logout/login) ou red√©marrer votre shell pour que le changement de groupe prenne effet.

**Astuce :** Utilisez `newgrp docker` pour activer le groupe sans vous d√©connecter.

**Alternative :** Pr√©fixer chaque commande avec `sudo` (ex: `sudo docker ps`) si vous ne voulez pas rejoindre le groupe.
--
--

[.notes]
--
**CONTEXTE - UBUNTU 25.04 ET PODMAN :**

Ubuntu 25.04 (Noble Numbat) marque un changement majeur : Podman devient le moteur de conteneurs par d√©faut √† la place de Docker.

**Pourquoi ce changement ?**
- Podman est "daemonless" (pas de daemon en root)
- Mieux int√©gr√© avec systemd
- Compatible OCI (Open Container Initiative)
- Plus s√©curis√© par d√©faut (rootless)

**Le conflit :**
- Podman cr√©e un socket `/run/podman/podman.sock` (ou rootless: `/run/user/$UID/podman/podman.sock`)
- Docker cherche `/var/run/docker.sock`
- Si les deux sont install√©s : confusion entre les sockets

**Solution 1 - DOCKER_HOST :**
‚úÖ Rapide, non-destructif
‚úÖ Permet de garder Podman install√©
‚ùå Doit √™tre configur√© pour chaque session/utilisateur
‚ùå Peut causer confusion si oubli√©

**Solution 2 - D√©sinstaller Podman :**
‚úÖ Solution propre et d√©finitive
‚úÖ Pas de configuration suppl√©mentaire
‚úÖ Recommand√© pour un cours Docker
‚ùå Supprime Podman si vous en avez besoin

**Pour le TP :**
- Recommander Solution 2 si les √©tudiants ne connaissent pas Podman
- Solution 1 acceptable pour tests rapides
- Dans GitHub Codespaces : aucun probl√®me, Docker pr√©configur√©

**Alternative bonus - Podman :**
Si vous voulez enseigner Podman au lieu de Docker :
[source,bash]
----
alias docker=podman
----
Podman est compatible avec la CLI Docker !

**MESSAGE CL√â :**
"Ubuntu 25.04 privil√©gie Podman, mais pour ce cours Docker, choisissez une solution claire : soit Docker seul, soit Podman avec alias. √âvitez d'avoir les deux install√©s simultan√©ment sans configuration."
--

[.small]
On peut commencer !

